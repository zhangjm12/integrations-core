<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="The home of Agent Integrations developer documentation" name="description"/><link href="https://datadoghq.dev/integrations-core/base/api/" rel="canonical"/><meta content="Datadog" name="author"/><link href="../../assets/images/favicon.ico" rel="shortcut icon"/><meta content="mkdocs-1.1, mkdocs-material-5.0.0rc4" name="generator"/><title>API - Agent Integrations</title><link href="../../assets/stylesheets/main.c1451e9e.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.4444686e.min.css" rel="stylesheet"/><meta content="#7e57c2" name="theme-color"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link href="../../assets/css/custom.css" rel="stylesheet"/></head> <body data-md-color-accent="deep-purple" data-md-color-primary="deep-purple" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#datadog_checks.base.checks.base.AgentCheck"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav aria-label="Header" class="md-header-nav md-grid"> <a aria-label="Agent Integrations" class="md-header-nav__button md-logo" href="https://datadoghq.dev/integrations-core/" title="Agent Integrations"> <img alt="logo" src="../../assets/images/logo.svg"/> </a> <label class="md-header-nav__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"></path></svg> </label> <div class="md-header-nav__title" data-md-component="header-title"> <div class="md-header-nav__ellipsis"> <span class="md-header-nav__topic md-ellipsis"> Agent Integrations </span> <span class="md-header-nav__topic md-ellipsis"> API </span> </div> </div> <label class="md-header-nav__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </label> <button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path></svg> </button> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Type to start searching </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> <div class="md-header-nav__source"> <a class="md-source" href="https://github.com/DataDog/integrations-core/" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </div> <div class="md-source__repository"> datadog/integrations-core </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav aria-label="Tabs" class="md-tabs md-tabs--active" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link md-tabs__link--active" href="../about/"> Base Package </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../ddev/layers/"> Dev Package </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../guidelines/style/"> Guidelines </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../meta/config_specs/"> Meta </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../process/integration_release/"> Process </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../faq/faq/"> FAQ </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Agent Integrations" class="md-nav__button md-logo" href="https://datadoghq.dev/integrations-core/" title="Agent Integrations"> <img alt="logo" src="../../assets/images/logo.svg"/> </a> Agent Integrations </label> <div class="md-nav__source"> <a class="md-source" href="https://github.com/DataDog/integrations-core/" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </div> <div class="md-source__repository"> datadog/integrations-core </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.." title="Home"> Home </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../setup/" title="Setup"> Setup </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../testing/" title="Testing"> Testing </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../e2e/" title="E2E"> E2E </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-5" id="nav-5" type="checkbox"/> <label class="md-nav__link" for="nav-5"> Base Package <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg> </span> </label> <nav aria-label="Base Package" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-5"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> Base Package </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../about/" title="About"> About </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../http/" title="HTTP"> HTTP </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../databases/" title="Databases"> Databases </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> API <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z"></path></svg> </span> </label> <a class="md-nav__link md-nav__link--active" href="./" title="API"> API </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> Table of contents </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck"> AgentCheck </a> <nav aria-label="AgentCheck" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.__init__"> __init__() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.count"> count() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.event"> event() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.gauge"> gauge() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.histogram"> histogram() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.historate"> historate() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.monotonic_count"> monotonic_count() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.rate"> rate() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.service_check"> service_check() </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#stubs"> Stubs </a> <nav aria-label="Stubs" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub"> AggregatorStub </a> <nav aria-label="AggregatorStub" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_all_metrics_covered"> assert_all_metrics_covered() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_event"> assert_event() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric"> assert_metric() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag"> assert_metric_has_tag() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag_prefix"> assert_metric_has_tag_prefix() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_metrics"> assert_no_duplicate_metrics() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_service_checks"> assert_no_duplicate_service_checks() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_service_check"> assert_service_check() </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub"> DatadogAgentStub </a> <nav aria-label="DatadogAgentStub" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.__init__"> __init__() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata"> assert_metadata() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata_count"> assert_metadata_count() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_config"> get_config() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_default_config"> get_default_config() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_hostname"> get_hostname() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_version"> get_version() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.log"> log() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.reset"> reset() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_check_metadata"> set_check_metadata() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_external_tags"> set_external_tags() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.tracemalloc_enabled"> tracemalloc_enabled() </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" id="nav-6" type="checkbox"/> <label class="md-nav__link" for="nav-6"> Dev Package <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg> </span> </label> <nav aria-label="Dev Package" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-6"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> Dev Package </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../ddev/layers/" title="What's in the box?"> What's in the box? </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ddev/test/" title="Test framework"> Test framework </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ddev/plugins/" title="Plugins"> Plugins </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ddev/configuration/" title="Configuration"> Configuration </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ddev/cli/" title="CLI"> CLI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" id="nav-7" type="checkbox"/> <label class="md-nav__link" for="nav-7"> Guidelines <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg> </span> </label> <nav aria-label="Guidelines" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-7"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> Guidelines </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../guidelines/style/" title="Style"> Style </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../guidelines/pr/" title="Pull requests"> Pull requests </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../guidelines/conventions/" title="Conventions"> Conventions </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" id="nav-8" type="checkbox"/> <label class="md-nav__link" for="nav-8"> Meta <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg> </span> </label> <nav aria-label="Meta" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-8"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> Meta </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../meta/config_specs/" title="Config specs"> Config specs </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../meta/ci/" title="CI"> CI </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../meta/cd/" title="CD"> CD </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" id="nav-9" type="checkbox"/> <label class="md-nav__link" for="nav-9"> Process <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg> </span> </label> <nav aria-label="Process" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-9"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> Process </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../process/integration_release/" title="Integration release"> Integration release </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../process/agent_release/" title="Agent release"> Agent release </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" id="nav-10" type="checkbox"/> <label class="md-nav__link" for="nav-10"> FAQ <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg> </span> </label> <nav aria-label="FAQ" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="nav-10"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> FAQ </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../faq/faq/" title="FAQ"> FAQ </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </span> Table of contents </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck"> AgentCheck </a> <nav aria-label="AgentCheck" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.__init__"> __init__() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.count"> count() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.event"> event() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.gauge"> gauge() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.histogram"> histogram() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.historate"> historate() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.monotonic_count"> monotonic_count() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.rate"> rate() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.checks.base.AgentCheck.service_check"> service_check() </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#stubs"> Stubs </a> <nav aria-label="Stubs" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub"> AggregatorStub </a> <nav aria-label="AggregatorStub" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_all_metrics_covered"> assert_all_metrics_covered() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_event"> assert_event() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric"> assert_metric() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag"> assert_metric_has_tag() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag_prefix"> assert_metric_has_tag_prefix() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_metrics"> assert_no_duplicate_metrics() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_service_checks"> assert_no_duplicate_service_checks() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_service_check"> assert_service_check() </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub"> DatadogAgentStub </a> <nav aria-label="DatadogAgentStub" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.__init__"> __init__() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata"> assert_metadata() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata_count"> assert_metadata_count() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_config"> get_config() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_default_config"> get_default_config() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_hostname"> get_hostname() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_version"> get_version() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.log"> log() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.reset"> reset() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_check_metadata"> set_check_metadata() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_external_tags"> set_external_tags() </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.tracemalloc_enabled"> tracemalloc_enabled() </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content"> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href="https://github.com/DataDog/integrations-core/blob/master/docs/developer/base/api.md" title="Edit this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"></path></svg> </a> <h1>API</h1> <hr/> <div class="doc doc-object doc-class"> <h3 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck"> <code>datadog_checks.base.checks.base.AgentCheck</code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck" title="Permanent link">¶</a></h3> <div class="doc doc-contents first"> <p>The base class for any Agent based integration.</p> <p>In general, you don't need to and you should not override anything from the base class except the <code>check</code> method but sometimes it might be useful for a Check to have its own constructor.</p> <p>When overriding <code>\_\_init\_\_</code> you have to remember that, depending on the configuration, the Agent might create several different Check instances and the method would be called as many times.</p> <p>Agent 6,7 signature:</p> <div class="highlight"> <pre><span></span><code>AgentCheck(name, init_config, instances)    # instances contain only 1 instance
AgentCheck.check(instance)
</code></pre> </div> <p>Agent 8 signature:</p> <div class="highlight"> <pre><span></span><code>AgentCheck(name, init_config, instance)     # one instance
AgentCheck.check()                          # no more instance argument for check method
</code></pre> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>when loading a Custom check, the Agent will inspect the module searching for a subclass of <code>AgentCheck</code>. If such a class exists but has been derived in turn, it'll be ignored - <strong>you should never derive from an existing Check</strong>.</p> </div> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.__init__"> <code class="highlight language-python"> __init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-special"><code>special</code></small> </span> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.__init__" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the check</li> <li><strong>init_config</strong> (<em>dict</em>) - the <code>init_config</code> section of the configuration.</li> <li><strong>instance</strong> (<em>List[dict]</em>) - a one-element list containing the instance options from the configuration file (a list is used to keep backward compatibility with older versions of the Agent).</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># type: (*Any, **Any) -&gt; None</span>
    <span class="sd">"""</span>
<span class="sd">    - **name** (_str_) - the name of the check</span>
<span class="sd">    - **init_config** (_dict_) - the `init_config` section of the configuration.</span>
<span class="sd">    - **instance** (_List[dict]_) - a one-element list containing the instance options from the</span>
<span class="sd">            configuration file (a list is used to keep backward compatibility with</span>
<span class="sd">            older versions of the Agent).</span>
<span class="sd">    """</span>
    <span class="c1"># NOTE: these variable assignments exist to ease type checking when eventually assigned as attributes.</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
    <span class="n">init_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'init_config'</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">agentConfig</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'agentConfig'</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'instances'</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">init_config</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># agent pass instances as tuple but in test we are usually using list, so we are testing for both</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">or</span> <span class="s1">'instances'</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># old-style init: the 3rd argument is `agentConfig`</span>
            <span class="n">agentConfig</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">instances</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># new-style init: the 3rd argument is `instances`</span>
            <span class="n">instances</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># NOTE: Agent 6+ should pass exactly one instance... But we are not abiding by that rule on our side</span>
    <span class="c1"># everywhere just yet. It's complicated... See: https://github.com/DataDog/integrations-core/pull/5573</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">instances</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">check_id</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>  <span class="c1"># type: str</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_config</span> <span class="o">=</span> <span class="n">init_config</span>  <span class="c1"># type: InitConfigType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">agentConfig</span> <span class="o">=</span> <span class="n">agentConfig</span>  <span class="c1"># type: AgentConfigType</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="n">instance</span>  <span class="c1"># type: Optional[InstanceType]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">instances</span> <span class="o">=</span> <span class="n">instances</span>  <span class="c1"># type: List[InstanceType]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: List[str]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># type: DefaultDict[str, List[str]]</span>

    <span class="c1"># `self.hostname` is deprecated, use `datadog_agent.get_hostname()` instead</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="n">datadog_agent</span><span class="o">.</span><span class="n">get_hostname</span><span class="p">()</span>  <span class="c1"># type: str</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">CheckLoggingAdapter</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="c1"># TODO: Remove with Agent 5</span>
    <span class="c1"># Set proxy settings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">proxies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_requests_proxy</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_config</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_agent_proxy</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_agent_proxy</span> <span class="o">=</span> <span class="n">is_affirmative</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'use_agent_proxy'</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

    <span class="c1"># TODO: Remove with Agent 5</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_integration_http_timeout</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agentConfig</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'default_integration_http_timeout'</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_deprecations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'increment'</span><span class="p">:</span> <span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="p">(</span>
                <span class="s1">'DEPRECATION NOTICE: `AgentCheck.increment`/`AgentCheck.decrement` are deprecated, please '</span>
                <span class="s1">'use `AgentCheck.gauge` or `AgentCheck.count` instead, with a different metric name'</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="s1">'device_name'</span><span class="p">:</span> <span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="p">(</span>
                <span class="s1">'DEPRECATION NOTICE: `device_name` is deprecated, please use a `device:` '</span>
                <span class="s1">'tag in the `tags` list instead'</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="s1">'in_developer_mode'</span><span class="p">:</span> <span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="s1">'DEPRECATION NOTICE: `in_developer_mode` is deprecated, please stop using it.'</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="s1">'no_proxy'</span><span class="p">:</span> <span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="p">(</span>
                <span class="s1">'DEPRECATION NOTICE: The `no_proxy` config option has been renamed '</span>
                <span class="s1">'to `skip_proxy` and will be removed in Agent version 6.13.'</span>
            <span class="p">),</span>
        <span class="p">),</span>
        <span class="s1">'service_tag'</span><span class="p">:</span> <span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="p">(</span>
                <span class="s1">'DEPRECATION NOTICE: The `service` tag is deprecated and has been renamed to `</span><span class="si">%s</span><span class="s1">`. '</span>
                <span class="s1">'Set `disable_legacy_service_tag` to `true` to disable this warning. '</span>
                <span class="s1">'The default will become `true` and cannot be changed in Agent version 8.'</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">}</span>  <span class="c1"># type: Dict[str, Tuple[bool, str]]</span>

    <span class="c1"># Setup metric limits</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metric_limiter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_metric_limiter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="p">)</span>

    <span class="c1"># Functions that will be called exactly once (if successful) before the first check run</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">check_initializations</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">send_config_metadata</span><span class="p">])</span>  <span class="c1"># type: Deque[Callable[[], None]]</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.count"> <code class="highlight language-python"> count<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.count" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Sample a raw count metric.</p> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the metric</li> <li><strong>value</strong> (<em>float</em>) - the value for the metric</li> <li><strong>tags</strong> (<em>List[str])</em>) - a list of tags to associate with this metric</li> <li><strong>hostname</strong> (<em>str</em>) - a hostname to associate with this metric. Defaults to the current host.</li> <li><strong>device_name</strong> (<em>str</em>) - <strong>deprecated</strong> add a tag in the form <code>device:&lt;device_name&gt;</code> to the <code>tags</code> list instead.</li> <li><strong>raw</strong> (<em>bool</em>) - whether to ignore any defined namespace prefix</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>461
462
463
464
465
466
467
468
469
470
471
472
473
474
475</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># type: (str, float, Sequence[str], str, str, bool) -&gt; None</span>
    <span class="sd">"""Sample a raw count metric.</span>

<span class="sd">    - **name** (_str_) - the name of the metric</span>
<span class="sd">    - **value** (_float_) - the value for the metric</span>
<span class="sd">    - **tags** (_List[str])_) - a list of tags to associate with this metric</span>
<span class="sd">    - **hostname** (_str_) - a hostname to associate with this metric. Defaults to the current host.</span>
<span class="sd">    - **device_name** (_str_) - **deprecated** add a tag in the form `device:&lt;device_name&gt;` to the `tags`</span>
<span class="sd">        list instead.</span>
<span class="sd">    - **raw** (_bool_) - whether to ignore any defined namespace prefix</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_submit_metric</span><span class="p">(</span>
        <span class="n">aggregator</span><span class="o">.</span><span class="n">COUNT</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="n">device_name</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.event"> <code class="highlight language-python"> event<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.event" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Send an event.</p> <p>An event is a dictionary with the following keys and data types:</p> <div class="highlight"> <pre><span></span><code><span class="p">{</span>
    <span class="s2">"timestamp"</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>        <span class="c1"># the epoch timestamp for the event</span>
    <span class="s2">"event_type"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>       <span class="c1"># the event name</span>
    <span class="s2">"api_key"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>          <span class="c1"># the api key for your account</span>
    <span class="s2">"msg_title"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>        <span class="c1"># the title of the event</span>
    <span class="s2">"msg_text"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>         <span class="c1"># the text body of the event</span>
    <span class="s2">"aggregation_key"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>  <span class="c1"># a key to use for aggregating events</span>
    <span class="s2">"alert_type"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>       <span class="c1"># (optional) one of ('error', 'warning', 'success', 'info'), defaults to 'info'</span>
    <span class="s2">"source_type_name"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="c1"># (optional) the source type name</span>
    <span class="s2">"host"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>             <span class="c1"># (optional) the name of the host</span>
    <span class="s2">"tags"</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>            <span class="c1"># (optional) a list of tags to associate with this event</span>
    <span class="s2">"priority"</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>         <span class="c1"># (optional) specifies the priority of the event ("normal" or "low")</span>
<span class="p">}</span>
</code></pre> </div> <ul> <li><strong>event</strong> (<em>dict</em>) - the event to be sent</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="c1"># type: (Event) -&gt; None</span>
    <span class="sd">"""Send an event.</span>

<span class="sd">    An event is a dictionary with the following keys and data types:</span>

<span class="sd">    ```python</span>
<span class="sd">    {</span>
<span class="sd">        "timestamp": int,        # the epoch timestamp for the event</span>
<span class="sd">        "event_type": str,       # the event name</span>
<span class="sd">        "api_key": str,          # the api key for your account</span>
<span class="sd">        "msg_title": str,        # the title of the event</span>
<span class="sd">        "msg_text": str,         # the text body of the event</span>
<span class="sd">        "aggregation_key": str,  # a key to use for aggregating events</span>
<span class="sd">        "alert_type": str,       # (optional) one of ('error', 'warning', 'success', 'info'), defaults to 'info'</span>
<span class="sd">        "source_type_name": str, # (optional) the source type name</span>
<span class="sd">        "host": str,             # (optional) the name of the host</span>
<span class="sd">        "tags": list,            # (optional) a list of tags to associate with this event</span>
<span class="sd">        "priority": str,         # (optional) specifies the priority of the event ("normal" or "low")</span>
<span class="sd">    }</span>
<span class="sd">    ```</span>

<span class="sd">    - **event** (_dict_) - the event to be sent</span>
<span class="sd">    """</span>
    <span class="c1"># Enforce types of some fields, considerably facilitates handling in go bindings downstream</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">text_type</span><span class="p">,</span> <span class="n">binary_type</span><span class="p">)):</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">event</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_native_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="c1"># ^ Mypy complains about dynamic key assignment -- arguably for good reason.</span>
            <span class="c1"># Ideally we should convert this to a dict literal so that submitted events only include known keys.</span>
        <span class="k">except</span> <span class="ne">UnicodeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">'Encoding error with field `</span><span class="si">%s</span><span class="s1">`, cannot submit event'</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'tags'</span><span class="p">):</span>
        <span class="n">event</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_tags_type</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'timestamp'</span><span class="p">):</span>
        <span class="n">event</span><span class="p">[</span><span class="s1">'timestamp'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s1">'timestamp'</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'aggregation_key'</span><span class="p">):</span>
        <span class="n">event</span><span class="p">[</span><span class="s1">'aggregation_key'</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_native_string</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s1">'aggregation_key'</span><span class="p">])</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__NAMESPACE__</span><span class="p">:</span>
        <span class="n">event</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">'source_type_name'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__NAMESPACE__</span><span class="p">)</span>

    <span class="n">aggregator</span><span class="o">.</span><span class="n">submit_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_id</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.gauge"> <code class="highlight language-python"> gauge<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.gauge" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Sample a gauge metric.</p> <p><strong>Parameters:</strong></p> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the metric</li> <li><strong>value</strong> (<em>float</em>) - the value for the metric</li> <li><strong>tags</strong> (<em>List[str])</em>) - a list of tags to associate with this metric</li> <li><strong>hostname</strong> (<em>str</em>) - a hostname to associate with this metric. Defaults to the current host.</li> <li><strong>device_name</strong> (<em>str</em>) - <strong>deprecated</strong> add a tag in the form <code>device:&lt;device_name&gt;</code> to the <code>tags</code> list instead.</li> <li><strong>raw</strong> (<em>bool</em>) - whether to ignore any defined namespace prefix</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">gauge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># type: (str, float, Sequence[str], str, str, bool) -&gt; None</span>
    <span class="sd">"""Sample a gauge metric.</span>

<span class="sd">    **Parameters:**</span>

<span class="sd">    - **name** (_str_) - the name of the metric</span>
<span class="sd">    - **value** (_float_) - the value for the metric</span>
<span class="sd">    - **tags** (_List[str])_) - a list of tags to associate with this metric</span>
<span class="sd">    - **hostname** (_str_) - a hostname to associate with this metric. Defaults to the current host.</span>
<span class="sd">    - **device_name** (_str_) - **deprecated** add a tag in the form `device:&lt;device_name&gt;` to the `tags`</span>
<span class="sd">        list instead.</span>
<span class="sd">    - **raw** (_bool_) - whether to ignore any defined namespace prefix</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_submit_metric</span><span class="p">(</span>
        <span class="n">aggregator</span><span class="o">.</span><span class="n">GAUGE</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="n">device_name</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.histogram"> <code class="highlight language-python"> histogram<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.histogram" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Sample a histogram metric.</p> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the metric</li> <li><strong>value</strong> (<em>float</em>) - the value for the metric</li> <li><strong>tags</strong> (<em>List[str])</em>) - a list of tags to associate with this metric</li> <li><strong>hostname</strong> (<em>str</em>) - a hostname to associate with this metric. Defaults to the current host.</li> <li><strong>device_name</strong> (<em>str</em>) - <strong>deprecated</strong> add a tag in the form <code>device:&lt;device_name&gt;</code> to the <code>tags</code> list instead.</li> <li><strong>raw</strong> (<em>bool</em>) - whether to ignore any defined namespace prefix</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>509
510
511
512
513
514
515
516
517
518
519
520
521
522
523</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># type: (str, float, Sequence[str], str, str, bool) -&gt; None</span>
    <span class="sd">"""Sample a histogram metric.</span>

<span class="sd">    - **name** (_str_) - the name of the metric</span>
<span class="sd">    - **value** (_float_) - the value for the metric</span>
<span class="sd">    - **tags** (_List[str])_) - a list of tags to associate with this metric</span>
<span class="sd">    - **hostname** (_str_) - a hostname to associate with this metric. Defaults to the current host.</span>
<span class="sd">    - **device_name** (_str_) - **deprecated** add a tag in the form `device:&lt;device_name&gt;` to the `tags`</span>
<span class="sd">        list instead.</span>
<span class="sd">    - **raw** (_bool_) - whether to ignore any defined namespace prefix</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_submit_metric</span><span class="p">(</span>
        <span class="n">aggregator</span><span class="o">.</span><span class="n">HISTOGRAM</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="n">device_name</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.historate"> <code class="highlight language-python"> historate<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.historate" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Sample a histogram based on rate metrics.</p> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the metric</li> <li><strong>value</strong> (<em>float</em>) - the value for the metric</li> <li><strong>tags</strong> (<em>List[str])</em>) - a list of tags to associate with this metric</li> <li><strong>hostname</strong> (<em>str</em>) - a hostname to associate with this metric. Defaults to the current host.</li> <li><strong>device_name</strong> (<em>str</em>) - <strong>deprecated</strong> add a tag in the form <code>device:&lt;device_name&gt;</code> to the <code>tags</code> list instead.</li> <li><strong>raw</strong> (<em>bool</em>) - whether to ignore any defined namespace prefix</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>525
526
527
528
529
530
531
532
533
534
535
536
537
538
539</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">historate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># type: (str, float, Sequence[str], str, str, bool) -&gt; None</span>
    <span class="sd">"""Sample a histogram based on rate metrics.</span>

<span class="sd">    - **name** (_str_) - the name of the metric</span>
<span class="sd">    - **value** (_float_) - the value for the metric</span>
<span class="sd">    - **tags** (_List[str])_) - a list of tags to associate with this metric</span>
<span class="sd">    - **hostname** (_str_) - a hostname to associate with this metric. Defaults to the current host.</span>
<span class="sd">    - **device_name** (_str_) - **deprecated** add a tag in the form `device:&lt;device_name&gt;` to the `tags`</span>
<span class="sd">        list instead.</span>
<span class="sd">    - **raw** (_bool_) - whether to ignore any defined namespace prefix</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_submit_metric</span><span class="p">(</span>
        <span class="n">aggregator</span><span class="o">.</span><span class="n">HISTORATE</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="n">device_name</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.monotonic_count"> <code class="highlight language-python"> monotonic_count<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.monotonic_count" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Sample an increasing counter metric.</p> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the metric</li> <li><strong>value</strong> (<em>float</em>) - the value for the metric</li> <li><strong>tags</strong> (<em>List[str])</em>) - a list of tags to associate with this metric</li> <li><strong>hostname</strong> (<em>str</em>) - a hostname to associate with this metric. Defaults to the current host.</li> <li><strong>device_name</strong> (<em>str</em>) - <strong>deprecated</strong> add a tag in the form <code>device:&lt;device_name&gt;</code> to the <code>tags</code> list instead.</li> <li><strong>raw</strong> (<em>bool</em>) - whether to ignore any defined namespace prefix</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>477
478
479
480
481
482
483
484
485
486
487
488
489
490
491</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">monotonic_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># type: (str, float, Sequence[str], str, str, bool) -&gt; None</span>
    <span class="sd">"""Sample an increasing counter metric.</span>

<span class="sd">    - **name** (_str_) - the name of the metric</span>
<span class="sd">    - **value** (_float_) - the value for the metric</span>
<span class="sd">    - **tags** (_List[str])_) - a list of tags to associate with this metric</span>
<span class="sd">    - **hostname** (_str_) - a hostname to associate with this metric. Defaults to the current host.</span>
<span class="sd">    - **device_name** (_str_) - **deprecated** add a tag in the form `device:&lt;device_name&gt;` to the `tags`</span>
<span class="sd">        list instead.</span>
<span class="sd">    - **raw** (_bool_) - whether to ignore any defined namespace prefix</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_submit_metric</span><span class="p">(</span>
        <span class="n">aggregator</span><span class="o">.</span><span class="n">MONOTONIC_COUNT</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="n">device_name</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.rate"> <code class="highlight language-python"> rate<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.rate" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Sample a point, with the rate calculated at the end of the check.</p> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the metric</li> <li><strong>value</strong> (<em>float</em>) - the value for the metric</li> <li><strong>tags</strong> (<em>List[str])</em>) - a list of tags to associate with this metric</li> <li><strong>hostname</strong> (<em>str</em>) - a hostname to associate with this metric. Defaults to the current host.</li> <li><strong>device_name</strong> (<em>str</em>) - <strong>deprecated</strong> add a tag in the form <code>device:&lt;device_name&gt;</code> to the <code>tags</code> list instead.</li> <li><strong>raw</strong> (<em>bool</em>) - whether to ignore any defined namespace prefix</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>493
494
495
496
497
498
499
500
501
502
503
504
505
506
507</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># type: (str, float, Sequence[str], str, str, bool) -&gt; None</span>
    <span class="sd">"""Sample a point, with the rate calculated at the end of the check.</span>

<span class="sd">    - **name** (_str_) - the name of the metric</span>
<span class="sd">    - **value** (_float_) - the value for the metric</span>
<span class="sd">    - **tags** (_List[str])_) - a list of tags to associate with this metric</span>
<span class="sd">    - **hostname** (_str_) - a hostname to associate with this metric. Defaults to the current host.</span>
<span class="sd">    - **device_name** (_str_) - **deprecated** add a tag in the form `device:&lt;device_name&gt;` to the `tags`</span>
<span class="sd">        list instead.</span>
<span class="sd">    - **raw** (_bool_) - whether to ignore any defined namespace prefix</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_submit_metric</span><span class="p">(</span>
        <span class="n">aggregator</span><span class="o">.</span><span class="n">RATE</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">device_name</span><span class="o">=</span><span class="n">device_name</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="n">raw</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.checks.base.AgentCheck.service_check"> <code class="highlight language-python"> service_check<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.checks.base.AgentCheck.service_check" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Send the status of a service.</p> <ul> <li><strong>name</strong> (<em>str</em>) - the name of the service check</li> <li><strong>status</strong> (<em>int</em>) - a constant describing the service status.</li> <li><strong>tags</strong> (<em>List[str])</em>) - a list of tags to associate with this service check</li> <li><strong>message</strong> (<em>str</em>) - additional information or a description of why this status occurred.</li> <li><strong>raw</strong> (<em>bool</em>) - whether to ignore any defined namespace prefix</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\checks\base.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">service_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># type: (str, ServiceCheckStatus, Sequence[str], str, str, bool) -&gt; None</span>
    <span class="sd">"""Send the status of a service.</span>

<span class="sd">    - **name** (_str_) - the name of the service check</span>
<span class="sd">    - **status** (_int_) - a constant describing the service status.</span>
<span class="sd">    - **tags** (_List[str])_) - a list of tags to associate with this service check</span>
<span class="sd">    - **message** (_str_) - additional information or a description of why this status occurred.</span>
<span class="sd">    - **raw** (_bool_) - whether to ignore any defined namespace prefix</span>
<span class="sd">    """</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_tags_type</span><span class="p">(</span><span class="n">tags</span> <span class="ow">or</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="n">hostname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hostname</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">to_native_string</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sanitize</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="n">aggregator</span><span class="o">.</span><span class="n">submit_service_check</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_namespace</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">raw</span><span class="p">),</span> <span class="n">status</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">message</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> </div> </div> </div> <h2 id="stubs">Stubs<a class="headerlink" href="#stubs" title="Permanent link">¶</a></h2> <div class="doc doc-object doc-class"> <h3 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub"> <code>datadog_checks.base.stubs.aggregator.AggregatorStub</code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub" title="Permanent link">¶</a></h3> <div class="doc doc-contents first"> <p>Mainly used for unit testing checks, this stub makes possible to execute a check without a running Agent.</p> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_all_metrics_covered"> <code class="highlight language-python"> assert_all_metrics_covered<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_all_metrics_covered" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>293
294
295
296
297
298
299
300
301
302</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_all_metrics_covered</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># use `condition` to avoid building the `msg` if not needed</span>
    <span class="n">condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics_asserted_pct</span> <span class="o">&gt;=</span> <span class="mf">100.0</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">condition</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">'</span><span class="se">\n\t</span><span class="s1">- '</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">'Some metrics are missing:'</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">Asserted Metrics:</span><span class="si">{}{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">prefix</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_asserted</span><span class="p">)))</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">Missing Metrics:</span><span class="si">{}{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">prefix</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">not_asserted</span><span class="p">())))</span>
    <span class="k">assert</span> <span class="n">condition</span><span class="p">,</span> <span class="n">msg</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_event"> <code class="highlight language-python"> assert_event<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_text</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">exact_match</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_event" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg_text</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">exact_match</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exact_match</span> <span class="ow">and</span> <span class="n">msg_text</span> <span class="o">!=</span> <span class="n">e</span><span class="p">[</span><span class="s1">'msg_text'</span><span class="p">]</span> <span class="ow">or</span> <span class="n">msg_text</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">e</span><span class="p">[</span><span class="s1">'msg_text'</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">tags</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">]):</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">e</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Candidates size assertion for `</span><span class="si">{}</span><span class="s2">`, count: </span><span class="si">{}</span><span class="s2">, at_least: </span><span class="si">{}</span><span class="s2">) failed"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg_text</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">at_least</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">==</span> <span class="n">count</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">at_least</span><span class="p">,</span> <span class="n">msg</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric"> <code class="highlight language-python"> assert_metric<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Assert a metric was processed by this stub</p> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_metric</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Assert a metric was processed by this stub</span>
<span class="sd">    """</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_asserted</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">expected_tags</span> <span class="o">=</span> <span class="n">normalize_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_aggregate</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">metric</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">expected_tags</span> <span class="ow">and</span> <span class="n">expected_tags</span> <span class="o">!=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">metric</span><span class="o">.</span><span class="n">tags</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">hostname</span> <span class="ow">and</span> <span class="n">hostname</span> <span class="o">!=</span> <span class="n">metric</span><span class="o">.</span><span class="n">hostname</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">metric_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">metric_type</span> <span class="o">!=</span> <span class="n">metric</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">device</span> <span class="o">!=</span> <span class="n">metric</span><span class="o">.</span><span class="n">device</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>

    <span class="n">expected_metric</span> <span class="o">=</span> <span class="n">MetricStub</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">metric_type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">candidates</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_aggregate</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">):</span>
        <span class="n">got</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Expected count value for '</span><span class="si">{}</span><span class="s2">': </span><span class="si">{}</span><span class="s2">, got </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">got</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">value</span> <span class="o">==</span> <span class="n">got</span>
    <span class="k">elif</span> <span class="n">count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Needed exactly </span><span class="si">{}</span><span class="s2"> candidates for '</span><span class="si">{}</span><span class="s2">', got </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">==</span> <span class="n">count</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Needed at least </span><span class="si">{}</span><span class="s2"> candidates for '</span><span class="si">{}</span><span class="s2">', got </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">at_least</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">at_least</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_assert</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">expected_stub</span><span class="o">=</span><span class="n">expected_metric</span><span class="p">,</span> <span class="n">submitted_elements</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span><span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag"> <code class="highlight language-python"> assert_metric_has_tag<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Assert a metric is tagged with tag</p> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_metric_has_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Assert a metric is tagged with tag</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_asserted</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">metric_name</span><span class="p">)</span>

    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">(</span><span class="n">metric_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">metric</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
            <span class="n">candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Candidates size assertion for `</span><span class="si">{}</span><span class="s2">`, count: </span><span class="si">{}</span><span class="s2">, at_least: </span><span class="si">{}</span><span class="s2">) failed"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric_name</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">at_least</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">==</span> <span class="n">count</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">at_least</span><span class="p">,</span> <span class="n">msg</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag_prefix"> <code class="highlight language-python"> assert_metric_has_tag_prefix<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">tag_prefix</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_metric_has_tag_prefix" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>385
386
387
388
389
390
391
392
393
394
395
396
397
398
399</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_metric_has_tag_prefix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="n">tag_prefix</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_asserted</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">metric_name</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metrics</span><span class="p">(</span><span class="n">metric_name</span><span class="p">):</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">tags</span>
        <span class="n">gtags</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tags</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">tag_prefix</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gtags</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Candidates size assertion for `</span><span class="si">{}</span><span class="s2">`, count: </span><span class="si">{}</span><span class="s2">, at_least: </span><span class="si">{}</span><span class="s2">) failed"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">metric_name</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">at_least</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">==</span> <span class="n">count</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">at_least</span><span class="p">,</span> <span class="n">msg</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_metrics"> <code class="highlight language-python"> assert_no_duplicate_metrics<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_metrics" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Assert no duplicate metrics have been submitted.</p> <p>Metrics are considered duplicate when all following fields match:</p> <ul> <li>metric name</li> <li>type (gauge, rate, etc)</li> <li>tags</li> <li>hostname</li> </ul> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_no_duplicate_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Assert no duplicate metrics have been submitted.</span>

<span class="sd">    Metrics are considered duplicate when all following fields match:</span>

<span class="sd">    - metric name</span>
<span class="sd">    - type (gauge, rate, etc)</span>
<span class="sd">    - tags</span>
<span class="sd">    - hostname</span>
<span class="sd">    """</span>
    <span class="c1"># metric types that intended to be called multiple times are ignored</span>
    <span class="n">ignored_types</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">COUNT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MONOTONIC_COUNT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">COUNTER</span><span class="p">]</span>
    <span class="n">metric_stubs</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metrics</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metrics</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignored_types</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">stub_to_key_fn</span><span class="p">(</span><span class="n">stub</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stub</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">stub</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">stub</span><span class="o">.</span><span class="n">tags</span><span class="p">)),</span> <span class="n">stub</span><span class="o">.</span><span class="n">hostname</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_assert_no_duplicate_stub</span><span class="p">(</span><span class="s1">'metric'</span><span class="p">,</span> <span class="n">metric_stubs</span><span class="p">,</span> <span class="n">stub_to_key_fn</span><span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_service_checks"> <code class="highlight language-python"> assert_no_duplicate_service_checks<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_no_duplicate_service_checks" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Assert no duplicate service checks have been submitted.</p> <p>Service checks are considered duplicate when all following fields match: - metric name - status - tags - hostname</p> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_no_duplicate_service_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Assert no duplicate service checks have been submitted.</span>

<span class="sd">    Service checks are considered duplicate when all following fields match:</span>
<span class="sd">        - metric name</span>
<span class="sd">        - status</span>
<span class="sd">        - tags</span>
<span class="sd">        - hostname</span>
<span class="sd">    """</span>
    <span class="n">service_check_stubs</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_checks</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">stub_to_key_fn</span><span class="p">(</span><span class="n">stub</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">stub</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">stub</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">stub</span><span class="o">.</span><span class="n">tags</span><span class="p">)),</span> <span class="n">stub</span><span class="o">.</span><span class="n">hostname</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_assert_no_duplicate_stub</span><span class="p">(</span><span class="s1">'service_check'</span><span class="p">,</span> <span class="n">service_check_stubs</span><span class="p">,</span> <span class="n">stub_to_key_fn</span><span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.aggregator.AggregatorStub.assert_service_check"> <code class="highlight language-python"> assert_service_check<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.aggregator.AggregatorStub.assert_service_check" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <p>Assert a service check was processed by this stub</p> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\aggregator.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_service_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">at_least</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Assert a service check was processed by this stub</span>
<span class="sd">    """</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="n">normalize_tags</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">service_checks</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">status</span> <span class="o">!=</span> <span class="n">sc</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">tags</span> <span class="ow">and</span> <span class="n">tags</span> <span class="o">!=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">tags</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">hostname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">hostname</span> <span class="o">!=</span> <span class="n">sc</span><span class="o">.</span><span class="n">hostname</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">message</span> <span class="o">!=</span> <span class="n">sc</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">candidates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>

    <span class="n">expected_service_check</span> <span class="o">=</span> <span class="n">ServiceCheckStub</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Needed exactly </span><span class="si">{}</span><span class="s2"> candidates for '</span><span class="si">{}</span><span class="s2">', got </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">==</span> <span class="n">count</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">"Needed at least </span><span class="si">{}</span><span class="s2"> candidates for '</span><span class="si">{}</span><span class="s2">', got </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">at_least</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">))</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">at_least</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_assert</span><span class="p">(</span>
        <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">expected_stub</span><span class="o">=</span><span class="n">expected_service_check</span><span class="p">,</span> <span class="n">submitted_elements</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_service_checks</span>
    <span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-class"> <h3 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub"> <code>datadog_checks.base.stubs.datadog_agent.DatadogAgentStub</code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub" title="Permanent link">¶</a></h3> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.__init__"> <code class="highlight language-python"> __init__<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <span class="doc doc-properties"> <small class="doc doc-property doc-property-special"><code>special</code></small> </span> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.__init__" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>7
8
9</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata"> <code class="highlight language-python"> assert_metadata<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>18
19
20
21
22
23
24</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_id</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">check_id</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">:</span>
            <span class="n">actual</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">data</span> <span class="o">==</span> <span class="n">actual</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata_count"> <code class="highlight language-python"> assert_metadata_count<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.assert_metadata_count" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>26
27</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">assert_metadata_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">)</span> <span class="o">==</span> <span class="n">count</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_config"> <code class="highlight language-python"> get_config<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_option</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_config" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>32
33</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_option</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">config_option</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_default_config"> <code class="highlight language-python"> get_default_config<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_default_config" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>11
12</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">get_default_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">'enable_metadata_collection'</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_hostname"> <code class="highlight language-python"> get_hostname<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_hostname" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>29
30</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">get_hostname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">'stubbed.hostname'</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_version"> <code class="highlight language-python"> get_version<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.get_version" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>35
36</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">get_version</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">'0.0.0'</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.log"> <code class="highlight language-python"> log<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.log" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>38
39</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.reset"> <code class="highlight language-python"> reset<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.reset" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>14
15
16</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_config</span><span class="p">()</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_check_metadata"> <code class="highlight language-python"> set_check_metadata<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_check_metadata" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>41
42</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">set_check_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">check_id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">[(</span><span class="n">check_id</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_external_tags"> <code class="highlight language-python"> set_external_tags<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.set_external_tags" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>44
45</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">set_external_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> <div class="doc doc-object doc-method"> <h4 class="doc doc-heading" id="datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.tracemalloc_enabled"> <code class="highlight language-python"> tracemalloc_enabled<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code> <a class="headerlink" href="#datadog_checks.base.stubs.datadog_agent.DatadogAgentStub.tracemalloc_enabled" title="Permanent link">¶</a></h4> <div class="doc doc-contents"> <details class="quote"> <summary>Source code in <code>datadog_checks\base\stubs\datadog_agent.py</code></summary> <table class="highlighttable"> <tr> <td class="linenos"> <div class="linenodiv"> <pre><span></span>47
48</pre> </div> </td> <td class="code"> <div class="highlight"> <pre><span></span><code><span class="k">def</span> <span class="nf">tracemalloc_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre> </div> </td> </tr> </table> </details> </div> </div> </div> </div> </div> <hr/> <div class="md-source-date"> <small> Last update: March 26, 2020 </small> </div> </article> </div> </div> </main> <footer class="md-footer"> <div class="md-footer-nav"> <nav aria-label="Footer" class="md-footer-nav__inner md-grid"> <a class="md-footer-nav__link md-footer-nav__link--prev" href="../databases/" rel="prev" title="Databases"> <div class="md-footer-nav__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg> </div> <div class="md-footer-nav__title"> <div class="md-ellipsis"> <span class="md-footer-nav__direction"> Previous </span> Databases </div> </div> </a> <a class="md-footer-nav__link md-footer-nav__link--next" href="../../ddev/layers/" rel="next" title="What's in the box?"> <div class="md-footer-nav__title"> <div class="md-ellipsis"> <span class="md-footer-nav__direction"> Next </span> What's in the box? </div> </div> <div class="md-footer-nav__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z"></path></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-footer-copyright"> <div class="md-footer-copyright__highlight"> Copyright © Datadog, Inc. 2020-present </div> made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> <div class="md-footer-social"> <a class="md-footer-social__link" href="https://www.datadoghq.com/blog/engineering/" rel="noopener" target="_blank" title="www.datadoghq.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M172.2 226.8c-14.6-2.9-28.2 8.9-28.2 23.8V301c0 10.2 7.1 18.4 16.7 22 18.2 6.8 31.3 24.4 31.3 45 0 26.5-21.5 48-48 48s-48-21.5-48-48V120c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24v248c0 89.5 82.1 160.2 175 140.7 54.4-11.4 98.3-55.4 109.7-109.7 17.4-82.9-37-157.2-112.5-172.2zM209 0c-9.2-.5-17 6.8-17 16v31.6c0 8.5 6.6 15.5 15 15.9 129.4 7 233.4 112 240.9 241.5.5 8.4 7.5 15 15.9 15h32.1c9.2 0 16.5-7.8 16-17C503.4 139.8 372.2 8.6 209 0zm.3 96c-9.3-.7-17.3 6.7-17.3 16.1v32.1c0 8.4 6.5 15.3 14.8 15.9 76.8 6.3 138 68.2 144.9 145.2.8 8.3 7.6 14.7 15.9 14.7h32.2c9.3 0 16.8-8 16.1-17.3-8.4-110.1-96.5-198.2-206.6-206.7z"></path></svg> </a> <a class="md-footer-social__link" href="https://github.com/DataDog" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg> </a> <a class="md-footer-social__link" href="https://twitter.com/datadoghq" rel="noopener" target="_blank" title="twitter.com"> <svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg> </a> <a class="md-footer-social__link" href="https://www.instagram.com/datadoghq" rel="noopener" target="_blank" title="www.instagram.com"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg> </a> </div> </div> </div> </footer> </div> <script src="../../assets/javascripts/vendor.23350dc5.min.js"></script> <script src="../../assets/javascripts/bundle.36a8f969.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.3bc815f0.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src="../../assets/js/custom.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.6/sequence-diagram-min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script> </body> </html>